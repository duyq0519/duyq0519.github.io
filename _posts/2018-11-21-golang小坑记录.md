---
layout: post
title: 'golang 处理价格'
date: 2018-10-23
categories: 数据库
cover: https://blog.mmschool.club/assets/img/sun.jpg
tags: golang
---

## golang 处理价格

### 四舍五入
> 今天接到一个处理价格的，比较复杂的价格，四舍五入，不同价格保留不同的小数位数
比如：
* 1～100, 小数点后4位
* 100～10,000，小数点后2位
golang是没有直接将浮点数四舍五入转换的，然后我就去网上找个四舍五入的函数。记得网上的有
两种方案，我都感觉很一般，也导致每次都取查。今天得到了一个比较好的答案：
```
fmt.Sprintf("%.2f", price)
```
> 浮点数在变量内部用户是无所谓四舍五入的，真正需要四舍五入的是输出的时候，这里的格式化会自动四舍五入。非常好的回答

### 抹零
这么写还是有问题的，不是每个价格都是很多位的，有的可能是整数，本来就很好看，你给来个90.00，这个不好看的，
之后用
```
strings.TrimRight(price, "0.")
```
这个是看起来很好，但是却有个小坑，90.0000进去，9出来。
所以只能嵌套，代码的确恶心
```
price:=90.0000
strings.TrimRight(strings.TrimRight(price, "0"), ".")
```

### 总结
* 使用前多测试下某个函数，要不然就是踩坑
* 注意多使用单元测试